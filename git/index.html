<!DOCTYPE html>
<html>
  <head>
    <link href="css/reset.css" rel="stylesheet" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link rel="shortcut icon" href="css/favicon.png" />
    <link rel="apple-touch-icon" href="css/apple-touch-icon.png" />
    <!-- Code Prettifier: -->
<link href="css/highlight.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

    <link href="css/style.css" rel="stylesheet" />
<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,800italic,300,400,800' rel='stylesheet' type='text/css'>    


  </head>

  <body>
  <div class="fallback-message">
  <p>Your browser <b>doesn't support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>
  <p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p>
  </div>
    <div id="impress">
    <div class='step' >
    
<h1>Git /ɡɪt/</h1>

<h2>the stupid content tracker</h2>

<p><a href="http://azuwis.github.com/slides/git/">http://azuwis.github.com/slides/git/</a></p>
</div>
      <div class='step'  data-x="1000">
    
<h1>Git 的特性</h1>

<ol>
<li><p>分支切换、合并代价小</p></li>
<li><p>小而快，大部分操作都是本地操作</p></li>
<li><p>分布式，每个人都有一份克隆，离线提交、在线同步</p></li>
<li><p>流行，github、google code、sourceforge，大用户群</p></li>
<li><p>可伸缩性，Linux kernel、Android</p></li>
</ol>

<p><a href="http://git-scm.com/about">http://git-scm.com/about</a></p>
</div>
      <div class='step'  data-x="1000" data-y="1000">
    
<h1>Git vs. SVN</h1>

<ol>
<li><p>Git 的大部分操作都比 SVN 快得多 (<a href="http://git-scm.com/about/small-and-fast">http://git-scm.com/about/small-and-fast</a>)</p></li>
<li><p>Git 的服务端仓库要比 SVN 小得多 (Mozilla 项目, 12G/420M ~= 1/30)</p></li>
<li><p>分支代价小，分支也包含整个历史 (svn 分支是一份拷贝，git 分支是一棵分叉的树)</p></li>
<li><p>合并容易，不需要记住分支版本号和复杂的操作</p></li>
<li><p>Git 仓库基本不会损坏，备份简单 (git clone 就是一次备份，有几个开发人员/用户就有几份备份，不担心代码丢失)</p></li>
<li><p>Snapshot vs. Delta</p></li>
</ol>

<p><a href="https://git.wiki.kernel.org/index.php/GitSvnComparsion">https://git.wiki.kernel.org/index.php/GitSvnComparsion</a></p>
</div>
      <div class='step'  data-x="1000" data-y="2000">
    
<h1>磁盘占用</h1>
<pre><code class='prettyprint '>$ git svn clone http://svn.apache.org/repos/asf/subversion/trunk subversion-git/
$ svn co http://svn.apache.org/repos/asf/subversion/trunk subversion-svn/
$ du -sh subversion-git/ subversion-svn/
137M    subversion-git
105M    subversion-svn
</code></pre>
<p>subversion 项目有 <strong>37024</strong> 次提交，subversion-git 含有所有历史</p>
<pre><code class='prettyprint '>$ cd subversion-git && git log --pretty=oneline | wc -l
37024
</code></pre></div>
      <div class='step'  data-x="2000">
    
<h1>安装</h1>
<pre><code class='prettyprint '>@debian/ubuntu: $ apt-get install git
@fedora/centos: $ yum install git
@windows -> msysgit(http://msysgit.github.com)
</code></pre>
<h2>Note:</h2>

<p>使用 1.6 版本以上的 git</p>

<p>msysgit line ending conversion: checkout as-is, commit as-is (core.autocrlf)</p>
</div>
      <div class='step'  data-x="2000" data-y="1000">
    
<h1>MSysGit vs. TortoiseGit</h1>

<blockquote>
<p><a href="http://code.google.com/p/chromium/wiki/UsingGit#Why_NOT_TortoiseGit">Chromium Project</a>: The primary reason not to use TortoiseGit is speed. ... TortoiseGit is too wasteful in polling status and the UI is too often unresponsive in a workable manner.</p>
</blockquote>

<p>推荐使用方式：用 GUI 看查看变动，用命令行作其他操作</p>

<p>Git 自带一些 GUI 工具：<code class='inline prettyprint'>gitk</code>、<code class='inline prettyprint'>git gui blame</code>、<code class='inline prettyprint'>git mergetool</code>、<code class='inline prettyprint'>git difftool</code> </p>
</div>
      <div class='step'  data-x="2000" data-y="2000">
    
<h1>配置 (git-completion)</h1>
<pre><code class='prettyprint bash'>$ vi ~/.bashrc
PS1='\[\033[01;31m\]$(__git_ps1 "(%s)")\[\033[00m\]'$PS1    # msysgit 不需要
GIT_PS1_SHOWDIRTYSTATE="true"
GIT_PS1_SHOWSTASHSTATE="true"
GIT_PS1_SHOWUNTRACKEDFILES="true"
GIT_PS1_SHOWUPSTREAM="auto"

(master *%=)azuwis@debian:~/src/mdpress$
</code></pre></div>
      <div class='step'  data-x="2000" data-y="3000">
    
<h1>配置 (git config)</h1>

<p>配置 Git 用户名和邮件地址，标识提交者的身份，在 github、gerrit 里面都会用到</p>
<pre><code class='prettyprint '>$ git config [--global] user.name "用户名"
$ git config [--global] user.email "邮件地址"
</code></pre>
<p>系统配置 <code class='inline prettyprint'>/etc/gitconfig</code>，用户配置 <code class='inline prettyprint'>~/.gitconfig</code>，仓库配置 <code class='inline prettyprint'>.git/config</code></p>
</div>
      <div class='step'  data-x="2000" data-y="4000">
    
<h1>配置 (git config)</h1>
<pre><code class='prettyprint bash'>$ git config --global -e    # 修改 ~/.gitconfig
[user]
        email = 邮件地址
        name = 用户名
[alias]
        co = checkout
        st = status
        di = diff
        ci = commit
        br = branch
        mt = mergetool
        sta = stash
        lg = log --graph --pretty=format:'%Cred%h%Creset%C(yellow)%d%Creset %s %Cgreen(%cr)%Creset%Cblue(%an)%Creset' --abbrev-commit --date=relative
# 以下 msysgit 不需要
[color]
        ui = auto
[core]
        pager = less
</code></pre></div>
      <div class='step'  data-x="3000">
    
<h1>获得帮助</h1>
<pre><code class='prettyprint '>$ git help tutorial
$ git help tutorial-2

$ git help
$ git help 子命令
</code></pre>
<p>带<code class='inline prettyprint'>-</code>的为不常用/内部命令</p>

<p><code class='inline prettyprint'>git status</code> 命令的输出有非常有用的提示</p>
</div>
      <div class='step'  data-x="3000" data-y="1000">
    
<h1>初始化仓库</h1>

<p>新建仓库</p>
<pre><code class='prettyprint '>$ git init 目录名
</code></pre>
<p>克隆仓库</p>
<pre><code class='prettyprint '>$ git clone ssh://git@github.com/foo/bar.git
$ git clone git://github.com/foo/bar.git
$ git clone https://github.com/foo/bar.git
$ git clone /path/to/repo
</code></pre></div>
      <div class='step'  data-x="3000" data-y="2000">
    
<h1>提交修改 (本地)</h1>

<p>修改文件</p>
<pre><code class='prettyprint '>$ vi 文件名
</code></pre>
<p>查看工作目录状态和修改内容</p>
<pre><code class='prettyprint '>$ git status
$ git diff
</code></pre>
<p>把修改的内容放到<strong>暂存区</strong></p>
<pre><code class='prettyprint '>$ git add [文件名|目录名]
</code></pre>
<p>查看暂存区的 diff</p>
<pre><code class='prettyprint '>$ git diff --cached
</code></pre>
<p>将暂存区的内容(<em>并非所有的本地修改</em>)提交到本地仓库</p>
<pre><code class='prettyprint '>$ git commit [-v]
</code></pre></div>
      <div class='step'  data-x="3000" data-y="3000">
    
<h1>暂存区(staging area)</h1>

<p><img src="image/staging.png" alt="staging"></p>
</div>
      <div class='step'  data-x="3000" data-y="4000">
    
<h1>分支、合并</h1>

<p>查看所有分支和当前所在的分支</p>
<pre><code class='prettyprint '>$ git branch
</code></pre>
<p>以当前的 HEAD 为分支点，新建分支</p>
<pre><code class='prettyprint '>$ git branch 分支名
</code></pre>
<p>切换分支</p>
<pre><code class='prettyprint '>$ git checkout 分支名
</code></pre>
<p>branch + checkout</p>
<pre><code class='prettyprint '>$ git checkout -b 分支名
</code></pre>
<p>合并另外一个分支的所有改动</p>
<pre><code class='prettyprint '>$ git merge 另一分支名
</code></pre></div>
      <div class='step'  data-x="3000" data-y="5000">
    
<h1>Git 的版本号</h1>

<p><code class='inline prettyprint'>git help revisions</code></p>

<ul>
<li>sha1: dae86e1950b1277e545cee180551750029cfe735, dae86e</li>
<li>分支名称: master, devel</li>
<li>标签: v0.1</li>
<li>rev..rev: devel..master, v0.1..HEAD</li>
</ul>
</div>
      <div class='step'  data-x="3000" data-y="6000">
    
<h1>查看变动</h1>

<p>查看提交日志</p>
<pre><code class='prettyprint '>$ git log [-p] [--all]
$ gitk [--all]
</code></pre>
<p>查看变动</p>
<pre><code class='prettyprint '>$ git diff
$ git diff v0.1
$ git diff v0.1..v0.2
$ git diff master..devel
$ git difftool ...
</code></pre>
<p>查看文件每行的最后变动</p>
<pre><code class='prettyprint '>$ git blame [master|v0.1|...] -- path/to/file
$ git gui blame [master|v0.1|...] -- path/to/file
</code></pre></div>
      <div class='step'  data-x="3000" data-y="7000">
    
<h1>推送到其他节点</h1>

<p>生成/使用已有 ssh 公私钥对</p>
<pre><code class='prettyprint '>$ ssh-keygen
</code></pre>
<p>打开 gerrit/github 设置页面，配置 ssh 公钥(<code class='inline prettyprint'>~/.ssh/id_rsa.pub</code>)</p>

<p>对于新建的仓库</p>
<pre><code class='prettyprint '>$ git remote add origin ssh://git@github.com/foo/bar.git
$ git push [-u] origin master
</code></pre>
<p>对于克隆的仓库</p>
<pre><code class='prettyprint '>$ git push   # 相当于 git push origin master
</code></pre></div>
      <div class='step'  data-x="3000" data-y="8000">
    
<h1>跟踪上游</h1>
<pre><code class='prettyprint '>$ git fetch origin
$ git merge origin/master
</code></pre>
<p>pull ~= fetch + merge</p>

<p>pull --rebase ~= fetch + rebase</p>

<p>谨慎用 <code class='inline prettyprint'>git pull</code></p>
</div>
      <div class='step'  data-x="3000" data-y="9000">
    
<h1>Merge, Rebase</h1>

<ul>
<li>Merge: 生成有两个父亲的提交节点</li>
<li>Rebase: 将一系列提交的根基移到另外一个分支上</li>
</ul>
<pre><code class='prettyprint no-highlight'>      A---B---C topic
     /
D---E---F---G master
</code></pre>
<p><code class='inline prettyprint'>@master $ git merge topic</code></p>
<pre><code class='prettyprint no-highlight'>      A---B---C topic
     /         \
D---E---F---G---H master
</code></pre>
<p><code class='inline prettyprint'>@topic $ git rebase master</code></p>
<pre><code class='prettyprint no-highlight'>              A'--B'--C' topic
             /
D---E---F---G master
</code></pre>
<p><code class='inline prettyprint'>@master $ git merge topic</code></p>
<pre><code class='prettyprint no-highlight'>              A'--B'--C' (master, topic)
             /
D---E---F---G
</code></pre></div>
      <div class='step'  data-x="3000" data-y="10000">
    
<h1>Merge 和 Rebase 的选择原则</h1>

<p>如果分支已经推送到服务端，并且已经被很多人同步，那不建议 rebase 这个分支</p>

<p>有冲突的情况下最好用 merge</p>

<p>本地提交量少的时候可以考虑用 rebase</p>
</div>
      <div class='step'  data-x="3000" data-y="11000">
    
<h1>Cherry-pick</h1>

<p>应用某一个/一些提交产生的变动</p>
<pre><code class='prettyprint no-highlight'>      A---B---C topic
     /
D---E---F---G master
</code></pre>
<p><code class='inline prettyprint'>@master $ git cherry-pick B</code></p>
<pre><code class='prettyprint no-highlight'>      A---B---C topic
     /
D---E---F---G---B' master
</code></pre></div>
      <div class='step'  data-x="3000" data-y="12000">
    
<h1>远端 (remote)</h1>

<p><code class='inline prettyprint'>$ git clone ssh://git@github.com:foo/bar.git</code></p>
<pre><code class='prettyprint no-highlight'>      A---B---C (origin/topic)
     /
D---E---F---G (master, origin/master)
</code></pre>
<p><code class='inline prettyprint'>@master $ vi file; git commit file</code></p>
<pre><code class='prettyprint no-highlight'>      A---B---C (origin/topic)
     /
D---E---F---G (origin/master)
             \
              H (master)
</code></pre>
<p><code class='inline prettyprint'>$ git fetch origin</code></p>
<pre><code class='prettyprint no-highlight'>      A---B---C (origin/topic)
     /
D---E---F---G---I (origin/master)
             \
              H (master)
</code></pre></div>
      <div class='step'  data-x="3000" data-y="13000">
    
<h1>多个远端</h1>
<pre><code class='prettyprint '>$ git clone ssh://git@github.com:foo/bar.git
$ vi file; git commit file
$ git remote add fork1 ssh://git@github.com/fork1/bar.git
$ git fetch fork1
</code></pre><pre><code class='prettyprint no-highlight'>      A---B---C (origin/topic, fork1/topic)
     /
D---E---F---G---I (origin/master)
         \   \
          \   H (master)
           \
            J---K (fork1/master)
</code></pre></div>
      <div class='step'  data-x="3000" data-y="14000">
    
<h1>.gitignore</h1>
<pre><code class='prettyprint bash'>$ cat .gitignore
*.class
*.jar
*.war
*.ear
</code></pre>
<p><a href="https://github.com/github/gitignore">https://github.com/github/gitignore</a></p>
</div>
      <div class='step'  data-x="4000">
    
<h1>Git - SVN 对应命令</h1>

<p><a href="http://git.or.cz/course/svn.html">http://git.or.cz/course/svn.html</a></p>
</div>
      <div class='step'  data-x="4000" data-y="1000">
    
<h1>git revert vs. svn revert</h1>

<p><code class='inline prettyprint'>git revert rev</code>: 生成跟某一 commit 相反的改动</p>

<p><code class='inline prettyprint'>svn revert path/to/file</code>: 撤销文件改动</p>

<p><code class='inline prettyprint'>git checkout path/to/file</code>: svn revert 的对应命令</p>
</div>
      <div class='step'  data-x="5000">
    
<h1>Tips &amp; Tricks</h1>

<p>整个历史全文检索</p>
<pre><code class='prettyprint '>$ git log -S'pattern'
</code></pre></div>
      <div class='step'  data-x="5000" data-y="1000">
    
<h1>Tips &amp; Tricks</h1>

<h2>git bisect: 二分法查找特定的提交(引入bug的提交)</h2>
<pre><code class='prettyprint '>#HEAD 不能编译，v1.2 能编译
$ git bisect start HEAD v1.2 --
$ git bisect run make
$ git bisect visualize
</code></pre></div>
      <div class='step'  data-x="5000" data-y="2000">
    
<h1>Tips &amp; Tricks</h1>

<h2>git stash: 暂存工作目录里没提交的内容(文件修改和暂存区)</h2>
<pre><code class='prettyprint '># ... hack hack hack ...
$ git stash
$ edit emergency fix
$ git commit -a -m "Fix in a hurry"
$ git stash pop
# ... continue hacking ...
</code></pre></div>
      <div class='step'  data-x="5000" data-y="3000">
    
<h1>Tips &amp; Tricks</h1>

<h2>git rebase -i: 交互式修改提交历史</h2>
</div>
      <div class='step'  data-x="5000" data-y="4000">
    
<h1>Tips &amp; Tricks</h1>

<h2>git mergetool, git difftool</h2>

<p>Windows 下可用 p4merge k3diff gvimdiff(gvim for windows) 等</p>

<p>Linux: opendiff kdiff3 tkdiff xxdiff <strong>meld</strong> kompare <strong>gvimdiff</strong> <strong>diffuse</strong> ecmerge p4merge araxis bc3 emerge vimdiff</p>
</div>
      <div class='step'  data-x="6000">
    
<h1>工作流程</h1>

<p><a href="http://git-scm.com/book/zh/%E5%88%86%E5%B8%83%E5%BC%8F-Git-%E5%88%86%E5%B8%83%E5%BC%8F%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B">http://git-scm.com/book/zh/分布式-Git-分布式工作流程</a></p>
</div>
      <div class='step'  data-x="7000">
    
<h1>其他前端</h1>

<ul>
<li>Eclipse: <a href="http://www.eclipse.org/egit/">http://www.eclipse.org/egit/</a></li>
<li>Visual Studio: <a href="http://code.google.com/p/gitextensions/">http://code.google.com/p/gitextensions/</a></li>
<li>Other: <a href="https://git.wiki.kernel.org/index.php/Interfaces,_frontends,_and_tools#Graphical_Interfaces">https://git.wiki.kernel.org/index.php/Interfaces,_frontends,_and_tools#Graphical_Interfaces</a></li>
</ul>
</div>
      <div class='step'  data-x="8000">
    
<h1>Git 的劣势</h1>

<ul>
<li>仓库是一个整体，没办法只克隆子目录</li>
<li>git submodules 比 svn:externals 弱爆了</li>
<li>浅克隆(shallow clone)只能 pull，不能 push</li>
<li>做不到目录级别的权限控制，分支级别的读权限控制有坑</li>
</ul>
</div>
      <div class='step'  data-x="9000">
    
<h1>其他资源</h1>

<p><strong><code class='inline prettyprint'>git help tutorial</code></strong></p>

<p><strong><code class='inline prettyprint'>git help tutorial-2</code></strong></p>

<p><a href="http://gitcasts.com/">http://gitcasts.com/</a></p>

<p><a href="http://git-scm.com/book">http://git-scm.com/book</a></p>

<p><a href="http://git-scm.com/book/zh">http://git-scm.com/book/zh</a></p>

<p><a href="http://git.or.cz/course/svn.html">http://git.or.cz/course/svn.html</a></p>

<p><a href="http://cheat.errtheblog.com/s/git">http://cheat.errtheblog.com/s/git</a></p>

<p><a href="http://schacon.github.com/git/user-manual.html">http://schacon.github.com/git/user-manual.html</a></p>

<p><a href="http://marklodato.github.com/visual-git-guide/index-en.html">http://marklodato.github.com/visual-git-guide/index-en.html</a></p>

      </div>
    <script src="js/impress.js"></script>
    <script>impress().init();</script>
  </body>
</html>
    
